{"version":3,"sources":["../../src/middleware/auth.js"],"names":["jwt","require","User","auth","req","res","next","token","header","replace","decoded","verify","findOne","_id","user","Error","status","send","error","module","exports"],"mappings":";;;;AAAA,IAAMA,MAAMC,QAAQ,cAAR,CAAZ;AACA,IAAMC,OAAOD,QAAQ,gBAAR,CAAb;;AAEA,IAAME;AAAA,uEAAO,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAECC,6BAFD,GAESH,IAAII,MAAJ,CAAW,eAAX,EAA4BC,OAA5B,CAAoC,SAApC,EAA8C,EAA9C,CAFT;AAGCC,+BAHD,GAGWV,IAAIW,MAAJ,CAAWJ,KAAX,EAAkB,YAAlB,CAHX;AAAA;AAAA,+BAIcL,KAAKU,OAAL,CAAa,EAAEC,KAAKH,QAAQG,GAAf,EAAoB,gBAAeN,KAAnC,EAAb,CAJd;;AAAA;AAICO,4BAJD;;AAAA,4BAKDA,IALC;AAAA;AAAA;AAAA;;AAAA,8BAMK,IAAIC,KAAJ,EANL;;AAAA;AAQLX,4BAAIU,IAAJ,GAAWA,IAAX;AACAV,4BAAIG,KAAJ,GAAYA,KAAZ;AACAD;AAVK;AAAA;;AAAA;AAAA;AAAA;;AAYLD,4BAAIW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,qBAAT,EAArB;;AAZK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAiBAC,OAAOC,OAAP,GAAiBjB,IAAjB","file":"auth.js","sourcesContent":["const jwt = require('jsonwebtoken')\nconst User = require('../models/user')\n\nconst auth = async (req, res, next) => {\n    try{\n        const token = req.header('Authorization').replace('Bearer ','')\n        const decoded = jwt.verify(token, 'matwazhere')\n        const user = await User.findOne({ _id: decoded._id, 'tokens.token':token })\n        if(!user){\n            throw new Error()\n        }\n        req.user = user\n        req.token = token\n        next()\n    }catch(error){\n        res.status(401).send({ error: \"Please authenticate\"})\n    }\n    \n}\n\nmodule.exports = auth"]}